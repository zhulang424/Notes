# 同步与异步

同步编程

代码按顺序依次执行。调用一个函数时，需等待其响应返回，才回执行后续代码。

> 同步编程，即是一种典型的请求-响应模型，当请求调用一个函数或方法后，需等待其响应返回，然后执行后续代码。

异步编程

在等待当前任务的响应返回之前，可以继续执行后续代码，即当前执行任务不会阻塞后续执行。

> 异步编程，不同于同步编程的请求-响应模式，其是一种事件驱动编程，请求调用函数或方法后，无需立即等待响应，可以继续执行其他任务，而之前任务响应返回后可以通过状态、通知和回调来通知调用者。

# JS 单线程

JS 是单线程。也就是说，同一时间只能做一件事

为什么是单线程？

> 与用于有关。JS 的主要用途是与用户交互和操作 DOM。这决定了 JS 必须是单线程，如果是多线程，会出现同步问题。
>
> 例如：如果两个线程同时操作一个DOM节点，一个线程修改了节点的内容，一个线程删除了该节点，就会出现问题。

# 同步任务和异步任务

为什么区分同步任务和异步任务？

> JS 是单线程，所以任务需要排队。前一个任务执行完，才会执行后一个任务。
>
> 有一些任务在等待结果时，耗时过长，所以要暂时挂起，继续执行后续任务，拿到运行结果后，再继续执行，这类任务被分为异步任务

同步任务

> 在主线程上执行的任务，执行完一个，再执行下一个

异步任务

> 回调函数，不进入主线程，先处于等待状态
>
> - 事件的回调函数
> - 定时器的回调函数

**所有同步任务执行完，才会执行异步任务，所以同步任务总是在异步任务之前执行！**

**设置回调函数是同步任务，调用回调函数是异步任务**

# 执行栈和任务队列

执行栈

> 同步任务在主线程上排队等待执行，构成执行栈
>
> **主线程只执行执行栈中的任务**

任务队列

> 事件构成的队列
>
> 当执行栈空了之后，主线程会读取任务队列中的事件，将对应的回调函数放入执行栈，开始执行

# 运行机制

> 1.同步任务进入执行栈，主线程依次执行
>
> 2.异步任务被挂起，事件触发后，事件进入任务队列
>
> 3.当执行栈空了（同步任务全部执行完毕，只剩异步任务），主线程读取任务队列中的事件，将事件对应的异步任务添加到执行栈，开始执行
>
> 4.主线程不断重复上个步骤

简单来说，就是同步任务执行玩，再执行各个回调函数

# EVENT LOOP

主线程循环的从任务队列中读取事件，这个过程被称为 EVENT LOOP

# 定时器

在一定时间间隔后，向任务队列中尾部添加一个事件

# 来源

[JavaScript 运行机制详解：再谈Event Loop](http://www.ruanyifeng.com/blog/2014/10/event-loop.html)